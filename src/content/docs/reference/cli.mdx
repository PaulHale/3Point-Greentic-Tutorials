---
title: "CLI Reference"
description: "Complete reference for the Greentic command-line tools"
---

# CLI Reference

Greentic provides several CLI tools for developing, testing, and deploying flows and components. The main tools are:

- **`greentic-flow`** — Flow authoring, validation, and component binding
- **`greentic-component`** — Component scaffolding, building, and testing
- **`greentic-pack`** — Pack building and deployment
- **`greentic-dev`** — Local development server and pack runner

## greentic-flow

The flow CLI edits YGTc v2 flows in-place and maintains a resolve sidecar (`<flow>.ygtc.resolve.json`) that tracks component bindings.

### new

Create a minimal v2 flow file:

```bash
greentic-flow new --flow flows/main.ygtc --id main --type messaging \
  [--schema-version 2] [--name "Title"] [--description "text"] [--force]
```

**Options:**
| Option | Description |
|--------|-------------|
| `--flow <PATH>` | Path to the flow file to create |
| `--id <ID>` | Unique identifier for the flow |
| `--type <TYPE>` | Flow type: `messaging`, `webhook`, `timer`, `websocket`, `pubsub` |
| `--schema-version <N>` | Schema version (default: 2) |
| `--name <TITLE>` | Human-readable title |
| `--description <TEXT>` | Flow description |
| `--force` | Overwrite existing file |

**Example:**
```bash
greentic-flow new --flow flows/support.ygtc --id support-bot --type messaging \
  --name "Support Bot" --description "IT support assistant"
```

### update

Non-destructive metadata edits (name, description, tags, id, type, schema_version):

```bash
greentic-flow update --flow flows/main.ygtc --name "New Title" --tags foo,bar
```

Preserves nodes and entrypoints. Changing `--type` is only allowed on empty flows. Fails if the file is missing.

### add-step

Insert a component-backed node and keep the sidecar in sync. Always writes v2 YAML.

**Local component (Wasm file):**
```bash
greentic-flow add-step --flow flows/main.ygtc \
  --node-id hello-world \
  --operation handle_message \
  --payload '{"input":"hi"}' \
  --local-wasm components/hello-world/target/wasm32-wasip2/release/hello_world.wasm
```

**Remote component (OCI registry):**
```bash
greentic-flow add-step --flow flows/main.ygtc \
  --node-id templates \
  --operation handle_message \
  --payload '{"input":"hi"}' \
  --component oci://ghcr.io/greentic-ai/components/templates:0.1.2 --pin
```

**Config mode (uses dev_flows for schema-valid payloads):**
```bash
greentic-flow add-step --flow flows/main.ygtc --mode config \
  --node-id hello-world \
  --component oci://ghcr.io/greentic-ai/components/hello-world:latest --pin \
  --after start
```

**Options:**
| Option | Description |
|--------|-------------|
| `--flow <PATH>` | Flow file to modify |
| `--node-id <ID>` | ID for the new node |
| `--operation <OP>` | Operation key (e.g., `handle_message`, `qa.process`) |
| `--payload <JSON>` | Operation payload as JSON |
| `--local-wasm <PATH>` | Path to local Wasm file |
| `--component <REF>` | Remote component reference (`oci://`, `repo://`, `store://`) |
| `--pin` | Hash local Wasm or resolve remote tag to digest |
| `--after <NODE>` | Insert after this node |
| `--mode <MODE>` | `default` or `config` (uses dev_flows) |
| `--answers <JSON>` | JSON object of answers for config mode questions |
| `--answers-file <PATH>` | File containing answers JSON |
| `--dry-run` | Print updated flow without writing |
| `--validate-only` | Plan/validate without changing files |

**Routing flags:**
| Flag | Description |
|------|-------------|
| `--routing-out` | Make the new node terminal (`routing: out`) |
| `--routing-reply` | Reply to origin (`routing: reply`) |
| `--routing-next <NODE>` | Route to a specific node |
| `--routing-multi-to a,b` | Fan out to multiple nodes |
| `--routing-json <FILE>` | Complex routing from JSON file |

### update-step

Re-materialise an existing node using its sidecar binding:

```bash
greentic-flow update-step --flow flows/main.ygtc --step hello \
  --answers '{"input":"hi again"}' --routing-reply
```

Prefills with current payload, merges answers, and preserves routing unless overridden. Requires a sidecar entry for the node.

### delete-step

Remove a node and optionally splice predecessors to its routing:

```bash
greentic-flow delete-step --flow flows/main.ygtc --step mid \
  [--strategy splice|remove-only] \
  [--if-multiple-predecessors error|splice-all] \
  [--assume-yes] [--write]
```

Default `splice` rewires predecessors to the deleted node's routes. Also removes the sidecar entry.

### bind-component

Attach or repair a sidecar mapping without changing flow content:

```bash
greentic-flow bind-component --flow flows/main.ygtc --step hello \
  --local-wasm components/hello-world/target/wasm32-wasip2/release/hello_world.wasm \
  [--pin] [--write]
```

Use when a node exists but its sidecar entry is missing or incorrect.

### doctor

Validate flows against the embedded schema and optional adapter registry:

```bash
# Validate all flows in a directory
greentic-flow doctor flows/

# Validate a single flow with JSON output
greentic-flow doctor --json --stdin < flows/main.ygtc
```

**Options:**
| Option | Description |
|--------|-------------|
| `--json` | Machine-readable report for one flow |
| `--registry` | Enable adapter_resolvable linting |

The doctor command also:
- Updates `*.ygtc.resolve.json` to drop stale node bindings
- Validates node payloads against component `config_schema` when available

### answers

Emit JSON Schema and example answers for a component operation:

```bash
greentic-flow answers --component <oci|path> --operation <op> \
  --name <prefix> [--out-dir <dir>] [--mode default|config]
```

Writes `<prefix>.schema.json` and `<prefix>.example.json`.

### doctor-answers

Validate answers JSON against a schema:

```bash
greentic-flow doctor-answers --schema answers.schema.json --answers answers.json [--json]
```

Exits 0 when valid, exits 1 with validation errors.

---

## greentic-component

Manage WebAssembly components.

### new

Scaffold a new component:

```bash
greentic-component new --name my-component --org ai.greentic --path ./components
```

**Options:**
| Option | Description |
|--------|-------------|
| `--name <NAME>` | Component name |
| `--org <ORG>` | Organisation namespace |
| `--path <PATH>` | Output directory |
| `--template <TPL>` | Template: `basic`, `llm`, `http`, `script` |

### build

Build a component to WebAssembly:

```bash
# In the component directory
cargo build --target wasm32-wasip2 --release
```

### validate

Validate a component structure and manifest:

```bash
greentic-component validate --path ./my-component
```

### test

Run component tests:

```bash
greentic-component test --path ./my-component [--filter "test_*"]
```

---

## greentic-pack

Manage Greentic packs (signed bundles of flows and components).

### build

Build a pack from flows and components:

```bash
greentic-pack build --in ./project --gtpack-out dist/my-pack.gtpack
```

**Options:**
| Option | Description |
|--------|-------------|
| `--in <DIR>` | Source directory containing flows |
| `--gtpack-out <FILE>` | Output pack file |
| `--version <VER>` | Pack version |
| `--sign` | Sign the pack |
| `--key <FILE>` | Signing key file |

### inspect

Inspect pack contents:

```bash
greentic-pack inspect --pack my-pack.gtpack [--json] [--extract <DIR>]
```

### sign

Sign an existing pack:

```bash
greentic-pack sign --pack my-pack.gtpack --key key.pem --cert cert.pem
```

### verify

Verify pack signature:

```bash
greentic-pack verify --pack my-pack.gtpack [--trusted-certs <DIR>]
```

---

## greentic-dev

Local development server for testing flows and packs.

### pack run

Run a pack locally:

```bash
greentic-dev pack run --pack dist/my-pack.gtpack [--mocks on|off]
```

**Options:**
| Option | Description |
|--------|-------------|
| `--pack <FILE>` | Pack file to run |
| `--mocks <MODE>` | Mock mode: `on`, `off` (default: `on`) |
| `--port <PORT>` | WebChat port (default: 3000) |

---

## Sidecar Files

When you use `greentic-flow` commands, a sidecar file (`<flow>.ygtc.resolve.json`) is maintained alongside your flow file. This tracks:

- **Node bindings** — Which component (local or remote) backs each node
- **Digests** — Pinned hashes for reproducible builds
- **Source references** — `file://` for local, `oci://` for remote

Example sidecar:
```json
{
  "schema_version": 1,
  "nodes": {
    "hello-world": {
      "source": {
        "kind": "local",
        "path": "components/hello-world/target/wasm32-wasip2/release/hello_world.wasm",
        "digest": "sha256:abc123..."
      }
    },
    "templates": {
      "source": {
        "kind": "remote",
        "reference": "oci://ghcr.io/greentic-ai/components/templates:0.1.2",
        "digest": "sha256:def456..."
      }
    }
  }
}
```

---

## Environment Variables

| Variable | Description |
|----------|-------------|
| `GREENTIC_CONFIG` | Config file path (`~/.greentic/config.toml`) |
| `RUST_LOG` | Log level (e.g., `greentic_flow=info`) |
| `OTEL_EXPORTER_OTLP_ENDPOINT` | Telemetry endpoint |

---

## CI Usage

Run validation in CI pipelines:

```bash
# Format, lint, and test
cargo fmt && cargo clippy --all-targets -- -D warnings && cargo test

# Validate all flows
greentic-flow doctor flows/
```

---

## Related

- [Quickstart](/docs/getting-started/quickstart) — Getting started guide
- [YGTC Schema](/docs/reference/ygtc-schema) — Flow file specification
- [Component Manifest](/docs/reference/component-manifest) — Component specification
